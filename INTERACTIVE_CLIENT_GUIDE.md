# 交互式客户端使用指南

## 快速开始

### 1. 启动服务
确保FastAPI服务正在运行：
```bash
python run_service.py
```

### 2. 启动交互式客户端
```bash
python interactive_client.py
```

### 3. 使用菜单进行操作
客户端会显示一个菜单，您可以选择相应的操作：

```
============================================================
           基金交易系统 - 交互式客户端
============================================================
1.  创建用户
2.  查询用户信息
3.  开通基金账户（开户）
4.  查询基金产品列表
5.  申购基金
6.  赎回基金
7.  查询用户资产
8.  创建基金产品（管理员）
9.  创建基金净值（管理员）
10. 完整业务流程演示
0.  退出
============================================================
```

## 业务操作流程

### 典型业务流程

#### 方式一：完整流程（推荐）
1. **创建用户** (选项1)
   - 输入用户姓名、身份证号等信息
   - 系统会记住当前用户ID

2. **开通基金账户** (选项3)
   - 系统会自动使用刚才创建的用户
   - 输入账户类型（默认：INDIVIDUAL）

3. **查询基金产品** (选项4)
   - 查看可购买的基金产品列表
   - 记录想要购买的产品ID

4. **申购基金** (选项5)
   - 系统会自动使用当前账户
   - 输入产品ID和申购金额

5. **查询用户资产** (选项7)
   - 查看当前持有的基金和总资产

6. **赎回基金** (选项6)
   - 输入产品ID和要赎回的份额

#### 方式二：使用已有用户/账户
如果您已经有用户ID或账户ID，可以直接使用：
- 在相应操作中，系统会提示是否使用当前用户/账户
- 选择 'n' 可以输入新的用户ID或账户ID

## 操作示例

### 示例1：创建用户并开户

```
请选择操作 (0-10): 1

【创建用户】
------------------------------------------------------------
用户姓名: 张三
身份证号: 320101199001011234
用户类型 [默认: PERSONAL]: 
手机号 [默认: 13800138000]: 
邮箱 [默认: 张三@example.com]: 

【创建成功】
------------------------------------------------------------
  用户ID: user_xxxxx
  用户姓名: 张三
------------------------------------------------------------

请选择操作 (0-10): 3

【开通基金账户】
------------------------------------------------------------
使用当前用户ID: user_xxxxx
是否使用当前用户? (Y/n): y
账户类型 [默认: INDIVIDUAL]: 

【开户成功】
------------------------------------------------------------
  基金账户ID: account_xxxxx
  用户ID: user_xxxxx
  账户类型: INDIVIDUAL
------------------------------------------------------------
```

### 示例2：申购基金

```
请选择操作 (0-10): 4

【查询基金产品列表】
------------------------------------------------------------
产品类型筛选（可选，如EQUITY/BOND/MIXED/MONETARY）: 

【找到 1 个产品】
------------------------------------------------------------
  产品 1:
    product_id: prod_xxxxx
    product_name: 测试基金
    product_type: EQUITY
    latest_nav: {'net_value': 1.2345, ...}
------------------------------------------------------------

请选择操作 (0-10): 5

【申购基金】
------------------------------------------------------------
使用当前账户ID: account_xxxxx
是否使用当前账户? (Y/n): y
产品ID: prod_xxxxx
申购金额（元）: 10000

【申购成功】
------------------------------------------------------------
  entrust_id: entrust_xxxxx
  share: 8100.00
  amount: 10000.00
  ...
------------------------------------------------------------
```

### 示例3：赎回基金

```
请选择操作 (0-10): 6

【赎回基金】
------------------------------------------------------------
使用当前账户ID: account_xxxxx
是否使用当前账户? (Y/n): y
产品ID: prod_xxxxx
赎回份额: 2000

【赎回成功】
------------------------------------------------------------
  entrust_id: entrust_xxxxx
  amount: 2469.00
  share: 2000.00
  ...
------------------------------------------------------------
```

## 高级功能

### 创建基金产品（管理员功能）
如果您需要创建新的基金产品：
1. 选择选项 8
2. 输入产品代码、名称、类型等信息
3. 创建后需要创建净值（选项9）才能进行交易

### 创建基金净值
基金产品需要净值才能进行申购/赎回：
1. 选择选项 9
2. 输入产品ID和单位净值
3. 可选输入累计净值

### 完整业务流程演示
选择选项 10 可以自动运行一个完整的业务流程演示，包括：
- 创建用户
- 开户
- 申购
- 查看资产
- 赎回

## 自定义配置

### 指定服务地址
```bash
python interactive_client.py http://localhost:8000 demo_token_2025
```

参数说明：
- 第一个参数：服务地址（默认：http://localhost:8000）
- 第二个参数：认证token（默认：demo_token_2025）

## 注意事项

1. **服务必须运行**：确保FastAPI服务在运行，否则无法连接
2. **认证token**：默认使用 `demo_token_2025`，如果服务端修改了token，需要相应修改
3. **用户状态**：客户端会记住当前用户和账户，方便连续操作
4. **数据验证**：所有输入都会进行验证，请按照提示输入正确的格式
5. **错误处理**：如果操作失败，会显示详细错误信息

## 常见问题

### Q: 连接失败怎么办？
A: 检查服务是否运行，端口是否正确（默认8000）

### Q: 如何查看所有可用的基金产品？
A: 选择选项4，不输入产品类型筛选条件，会显示所有产品

### Q: 申购/赎回时提示账户不存在？
A: 请先完成开户操作（选项3）

### Q: 如何查看我的资产？
A: 选择选项7，输入用户ID或使用当前用户

## 技术支持

如有问题，请检查：
1. 服务日志
2. 网络连接
3. 输入参数格式

